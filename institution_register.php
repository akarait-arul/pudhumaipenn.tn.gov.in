<!DOCTYPE html>
<html lang="en-US" dir="ltr">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- ===============================================-->
  <!--    Document Title-->
  <!-- ===============================================-->
  <title>Moovalur Ramamirtham Ammaiyar Higher Education Assurance Scheme - College Login</title>

  <!-- ===============================================-->
  <!--    Favicons-->
  <!-- ===============================================-->
  <link rel="apple-touch-icon" sizes="180x180" href="./assets/img/favicons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="./assets/img/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./assets/img/favicons/favicon-16x16.png">
  <link rel="shortcut icon" type="image/x-icon" href="./assets/img/favicons/favicon.ico">
  <link rel="manifest" href="./assets/img/favicons/manifest.json">
  <meta name="msapplication-TileImage" content="./assets/img/favicons/mstile-150x150.png">
  <meta name="theme-color" content="#ffffff">
  <script src="./assets/js/config.js"></script>
  <script src="./vendors/overlayscrollbars/OverlayScrollbars.min.js"></script>
  <link href="assets/css/custom.css" rel="stylesheet" id="custom-css">
  <!-- ===============================================-->
  <!--    Stylesheets-->
  <!-- ===============================================-->
  <link rel="preconnect" href="https://fonts.gstatic.com/">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700%7cPoppins:300,400,500,600,700,800,900&amp;display=swap" rel="stylesheet">
  <link href="./assets/css/theme.min.css" rel="stylesheet" id="style-default">

  <!-- Custom Files Include Starts Here -->

  <link rel='stylesheet' href="./assets/css/custom.css" rel="stylesheet" id="user-style-default">
  <link rel='stylesheet' href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/fontawesome.min.css" rel="stylesheet" id="user-style-default">
  <link rel='stylesheet' href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet" id="user-style-default">
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css'>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" crossorigin="anonymous"></script>

  <!-- Custom Files Include Ends Here -->

  <script>
    (function() {

      'use strict'

      // Fetch all the forms we want to apply custom Bootstrap validation styles to
      var forms = document.querySelectorAll('.needs-validation')

      // Loop over them and prevent submission
      Array.prototype.slice.call(forms)
        .forEach(function(form) {

          form.addEventListener('submit', function(event) {

            if (!form.checkValidity()) {

              event.preventDefault();
              event.stopPropagation();

            } else {

              event.preventDefault();
              UserLogin();

            }

            form.classList.add('was-validated')
          }, false)
        })

    })()
  </script>

</head>

<body>

  <!-- ===============================================-->
  <!--    Main Content-->
  <!-- ===============================================-->
  <main class="main" id="top">

    <div class="container-fluid text-center">
      <div class="row align-items-center">
        <div class="col-4 text-start">
          <img src="assets/img/logos/ex-cm-kalaignar.jpg" class="img-fluid logo rounded-circle float-start">
        </div>
        <div class="col-4 text-center">
          <img src="assets/img/logos/tamilnadu_logo.png" class="img-fluid">
        </div>
        <div class="col-4 text-end">
          <img src="assets/img/logos/hon-cm-mkstalin.jpg" class="img-fluid logo rounded-circle float-end">
        </div>
      </div>
      <div class="row ">
        <div class="col-md-12">
          <h4 class="sub-heading">
            <small>
              Government Of Tamil Nadu
            </small>
          </h4>
          <h3 class="main-heading text-sm-center">
            Department of Social Welfare and Women Empowerment</h3>
        </div>
      </div>
      <div class="row flex-center g-0">
        <div class="col-lg-10 col-xxl-8 py-3 position-relative">
          <div class="card overflow-hidden z-index-1">
            <div class="card-body p-0">
              <div class="row g-0 h-100">
                <div class="col-md-5 text-center bg-card-gradient">
                  <div class="position-relative p-4 pt-md-5 pb-md-7 light">
                    <div class="bg-holder bg-auth-card-shape" style="background-image:url(./assets/img/icons/spot-illustrations/half-circle.png);"></div>
                    <!--/.bg-holder-->
                    <div class="z-index-1 position-relative">
                      <h4 class="link-light mb-4 font-Times New Roman-Serif fs-2 d-inline-block fw-bolder">PUDHUMAI PENN SCHEME</h4>
                      </a>
                      <p class="opacity-75 text-white font-Times New Roman-Serif text-justify">The Government of TamilNadu has launched Moovalur Ramamirtham Ammaiyar Higher Education Assurance Scheme to enhance the enrolment ratio of girls from Government schools to Higher Education Institutions. Through this scheme, the financial assistance of Rs. 1000/month will be provided to the girls till their completion of UG degree/Diploma/ITI/any other recognized course. The incentive amount under this scheme will be disbursed directly into the studentâ€™s Bank Account.</p>
                    </div>
                  </div>
                </div>
                <div class="col-md-7 d-flex flex-center">
                  <div class="p-4 p-md-5 flex-grow-1">
                    <div class="row flex-between-center">
                      <div class="col-auto">
                        <h3>Institution Register</h3>
                      </div>
                    </div>
                    <div class="col-8 align-self-center loader"></div>
                    <form class="needs-validation" id="institution_register" name="institution_register" novalidate autocomplete="off">
                      <div class="row gx-2">
                        <div class="mb-3 col-sm-6">
                          <div class="d-flex justify-content-between">
                            <label class="form-label" for="card-password">Email *</label>
                          </div>
                          <input class="form-control" type="text" id="email_id" name="email_id" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$" required />
                          <div class="invalid-feedback text-justify"> Please Enter Email Id </div>
                        </div>
                        <div class="mb-3 col-sm-6">
                          <div class="d-flex justify-content-between">
                            <label class="form-label" for="card-confirm-password">Mobile Number *</label>
                          </div>
                          <input class="form-control" type="text" id="mobile_number" name="mobile_number" pattern="^[6-9]\d{9}$" required />
                          <div class="invalid-feedback text-justify"> Please Enter Mobile Number</div>
                        </div>
                      </div>
                      <div class="row gx-2">

                        <div class="mb-3 col-sm-6">
                          <div class="d-flex justify-content-between">
                            <label class="form-label" for="card-password">Contact Person *</label>
                          </div>
                          <input class="form-control" type="text" id="contact_person" name="contact_person" pattern="^[A-Za-z ]{1,32}$" required />
                          <div class="invalid-feedback text-justify"> Please Enter Contact Person</div>
                        </div>

                        <div class="mb-3 col-sm-6">

                          <div class="d-flex  ">
                            <label class="form-label" for="card-name"> Institution Type * </label>
                          </div>
                          <!--  <select class="form-select" id="institution_type" name="institution_type[]"   multiple="multiple"   required> -->
                          <select class="form-select" id="m_institution_type_id" name="m_institution_type_id" required>

                          </select>
                          <div class="invalid-feedback text-justify"> Please Select Institution</div>




                        </div>


                      </div>

                      <div class="row gx-2">
                        <div class="mb-3 col-sm-4">
                          <div class="d-flex justify-content-between">
                            <label class="form-label" for="card-confirm-password">District *</label>
                          </div>
                          <select class="form-select" id="m_district_code" name="m_district_code" required>

                          </select>
                          <div class="invalid-feedback text-justify"> Please Select District</div>


                        </div>

                        <div class="mb-3 col-sm-8">
                          <div class="d-flex justify-content-between">
                            <label class="form-label" for="card-name">Institution *</label>
                          </div>
                          <select class="form-select" id="m_institution_id" name="m_institution_id" required>

                          </select>
                          <div class="invalid-feedback text-justify"> Please Select Institution</div>


                        </div>

                      </div>
                       

                       
                      <div class="mb-3">
                        <div class="d-flex justify-content-between">
                          <label class="form-label" for="card-email">Address *</label>
                        </div>
                        <input class="form-control" type="text" id="address" name="address" required />
                        <div class="invalid-feedback text-justify"> Please Enter Address</div>
                      </div>
                      <div class="row gx-2">
                        <div class="mb-3 col-sm-6">
                          <div class="d-flex justify-content-between">
                            <label class="form-label" for="card-password">Pincode *</label>
                          </div>
                          <input class="form-control" type="text" id="pincode" name="pincode" pattern="^[0-9]\d{5}$" required />
                          <div class="invalid-feedback text-justify"> Please Enter valid Pincode</div>
                        </div>
                      </div>
                      <div class="mb-3">
                        <button class="btn btn-primary d-block w-100 mt-3" type="submit" name="submit">Register</button>
                      </div>

                      <div class="row mt-3">
                        <div class="col-md-5"></div>
                        <div class="col-md-4">
                          <a href="index.php" class=" " role="button"> Back to Login </a>
                        </div>
                        <div class="col-md-5"> </div>
                      </div>

                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- OTP Modal-->
  <div class="modal fade" id="otp_modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="col-8 align-self-center loader_modal"></div>
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header text-center">
          <h5 class="modal-title text-center text-2xl font-bold" id="staticBackdropLabel">Enter <span id="tmp_otp_msg"></span></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <form class="row-auto g-3 needs-validation" novalidate id="submit_otp">
          <div class="modal-body">
            <div>
              <div class="container height-100 d-flex justify-content-center align-items-center">
                <div class="position-relative">

                  <h6 class="text-center">Please enter the OTP to verify your account</h6>

                  <div id="otp" class="inputs d-flex flex-row justify-content-center mt-2">
                    <input class="m-2 text-center form-control rounded" type="text" id="first" maxlength="1" />
                    <input class="m-2 text-center form-control rounded" type="text" id="second" maxlength="1" />
                    <input class="m-2 text-center form-control rounded" type="text" id="third" maxlength="1" />
                    <input class="m-2 text-center form-control rounded" type="text" id="fourth" maxlength="1" />
                    <input class="m-2 text-center form-control rounded" type="text" id="fifth" maxlength="1" />
                    <input class="m-2 text-center form-control rounded" type="text" id="sixth" maxlength="1" />
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="text-center mt-5">
            <span class="d-block mobile-text fw-bolder" id="countdown"></span>
            <span class="d-block mobile-text fw-bolder" id="resend"></span>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary">Submit</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <!-- OTP Modal Ends Here-->

  <!-- ===============================================-->
  <!--    End of Main Content-->
  <!-- ===============================================-->

  <!-- ===============================================-->
  <!--    JavaScripts-->
  <!-- ===============================================-->
  <script src="./vendors/popper/popper.min.js"></script>
  <script src="./vendors/bootstrap/bootstrap.min.js"></script>
  <script src="./vendors/anchorjs/anchor.min.js"></script>
  <script src="./vendors/is/is.min.js"></script>
  <script src="./vendors/fontawesome/all.min.js"></script>
  <script src="./vendors/lodash/lodash.min.js"></script>
  <script src="./vendors/polyfill.io/v3/polyfill.min58be.js?features=window.scroll"></script>
  <script src="./vendors/list.js/list.min.js"></script>
  <script src="./assets/js/theme.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.29/dist/sweetalert2.all.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.29/dist/sweetalert2.min.css">

  <script src="./vendors/preloader/js/jquery.preloader.min.js"></script>
  <link rel="stylesheet" href="./vendors/preloader/css/preloader.css">


  <!-- select2  links -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- select2  links -->





  <script>
    $(document).ready(function() {

      getDistrict();
      getInstitutionType()
      //$('#m_institution_type_id').select2();

    });

    document.addEventListener("DOMContentLoaded", function(event) {

      function OTPInput() {
        const inputs = document.querySelectorAll('#otp > *[id]');
        for (let i = 0; i < inputs.length; i++) {
          inputs[i].addEventListener('keydown', function(event) {
            if (event.key === "Backspace") {
              inputs[i].value = '';
              if (i !== 0) inputs[i - 1].focus();
            } else {
              if (i === inputs.length - 1 && inputs[i].value !== '') {
                return true;
              } else if (event.keyCode >= 47 && event.keyCode <= 57) {
                inputs[i].value = event.key;
                if (i !== inputs.length - 1) inputs[i + 1].focus();
                event.preventDefault();
              } else if (event.keyCode >= 47 && event.keyCode <= 57) {
                inputs[i].value = event.key;
                if (i !== inputs.length - 1) inputs[i + 1].focus();
                event.preventDefault();
              }
            }
          });
        }
      }
      OTPInput();

    });


    let timerOn = true;

    function timer(remaining) {
      var m = Math.floor(remaining / 60);
      var s = remaining % 60;
      m = m < 10 ? "0" + m : m;
      s = s < 10 ? "0" + s : s;
      document.getElementById("countdown").innerHTML = `Time left: ${m} : ${s}`;
      remaining -= 1;
      if (remaining >= 0 && timerOn) {
        setTimeout(function() {
          timer(remaining);
        }, 1000);
        document.getElementById("resend").innerHTML = ``;
        return;
      }
      if (!timerOn) {
        return;
      }
      document.getElementById("resend").innerHTML = "Don't receive the code? <span class='font-weight-bold text-color cursor' onclick='timer(60)'>Resend</span>";
    }
    timer(180);


    // Institution Registration Get District
    function getDistrict() {

      $.ajax({

        method: "POST",
        url: "ajax.php",
        data: {
          type: 'GetDistrict'
        },
        beforeSend: function() {
          $('.loader').preloader({
            text: 'Loading Please Wait ....'
          });
        },
        complete: function() {
          $('.loader').preloader('remove');
        },
        success: function(response) {

          resdata = $.parseJSON(response);
          if (resdata['error_code'] == 200 && resdata['error_msg'] != 0) {

            $('#m_district_code').empty().append();
            $('#m_district_code')
              .append($("<option></option>")
                .attr("value", '')
                .text('Select District'));
            $.each(resdata['error_msg'], function(index, value) {
              $('#m_district_code')
                .append($("<option></option>")
                  .attr("value", value['district_code'])
                  .text(value['district_name']));
            });

          } else if (resdata['error_code'] == 200 && resdata['error_msg'] != 0) {

            Swal.fire(resdata['error_msg'])

          }

        }

      });

    }



    //get institution type
    function getInstitutionType() {

      $.ajax({

        method: "POST",
        url: "ajax.php",
        data: {
          type: 'GetInsitutionType',
          institution_id: "all"
        },
        beforeSend: function() {
          $('.loader').preloader({
            text: 'Loading Please Wait ....'
          });
        },
        success: function(response) {

          $('.loader').preloader('remove');
          resdata = $.parseJSON(response);
          if (resdata['error_code'] == 200 && resdata['error_msg'] != 0) {

            $('#m_institution_type_id').empty().append();
            $('#m_institution_type_id').append($("<option></option>").attr("value", '').text('Select Institute Type'));
            $.each(resdata['error_msg'], function(index, value) {
              $('#m_institution_type_id').append($("<option></option>").attr("value", value['m_institution_type_id']).text(value['institution_type']));
            });

          } else if (resdata['error_code'] == 200 && resdata['error_msg'] != 0) {

            Swal.fire(resdata['error_msg'])

          }

        }

      });


    }

    //get institution type


    //OnChange Get Institution Based On District Code
    $("#m_district_code").change(function(e) {

      var district = $("#m_district_code").val();
      if (district && district != 0) {

        $.ajax({
          method: "POST",
          url: "ajax.php",
          data: {
            district: district,
            type: 'GetInstitutions'
          },
          success: function(response) {

            resdata = $.parseJSON(response);
            if (resdata['error_code'] == 200 && resdata['error_msg'] != 0) {

              $('#m_institution_id').empty().append();
              $('#m_institution_id')
                .append($("<option></option>")
                  .attr("value", '')
                  .text('Select Institution'));
              $.each(resdata['error_msg'], function(index, value) {
                $('#m_institution_id')
                  .append($("<option></option>")
                    .attr("value", value['m_institution_id'])
                    .text(value['institution_name']));
              });

            } else if (resdata['error_code'] == 400 && resdata['error_msg'] != 0) {

              Swal.fire({
                icon: 'error',
                title: 'Alert',
                text: resdata['error_msg']
              })

            }
          }
        });

      }

    });

    // Student Registration Submit OTP Form     
    $("#institution_register").submit(function(e) {

      var formdata = $("#institution_register").serializeArray();
      if (formdata) {

        $.ajax({

          method: "POST",
          url: "ajax.php",
          data: {
            formdata: formdata,
            type: 'InstitutionRegister'
          },
          beforeSend: function() {
            $('.loader').preloader({
              text: 'Loading Please Wait ....'
            });
          },
          complete: function() {
            $('.loader').preloader('remove');
          },
          success: function(response) {

            resdata = $.parseJSON(response);
            if (resdata['error_code'] == 200 && resdata['error_msg'] != 0) {

              $('#tmp_otp_msg').html(resdata['error_msg']);
              $('#otp_modal').modal('show');

            } else if (resdata['error_code'] == 400 && resdata['error_msg'] != 0) {

              Swal.fire({
                icon: 'error',
                title: 'Alert',
                text: resdata['error_msg']
              })

            }

          }

        });

      }

      e.preventDefault();

    });



    // Submit OTP 
    $("#submit_otp").submit(function(e) {

      var formdata = $("#institution_register").serializeArray();
      var otp_number = $("#first").val() + $("#second").val() + $("#third").val() + $("#fourth").val() + $("#fifth").val() + $("#sixth").val();
      if (formdata != '' && otp_number.length == 6) {

        $.ajax({

          method: "POST",
          url: "ajax.php",
          data: {

            formdata: formdata,
            otp_number: otp_number,
            type: 'SubmitInstitutionOTP'

          },
          beforeSend: function() {
            $('.loader_modal').preloader({
              text: 'Loading Please Wait ....'
            });
          },
          complete: function() {
            $('.loader_modal').preloader('remove');
          },
          success: function(response) {

            resdata = $.parseJSON(response);
            if (resdata['error_code'] == 200 && resdata['error_msg'] != 0) {

              $('#otp_modal').modal('hide');
              Swal.fire({
                icon: 'success',
                title: "Success Message",
                text: resdata['error_msg'],
                type: "success"
              }).then(function() {
                location.reload();
              });

            } else if (resdata['error_code'] >= 400 && resdata['error_msg'] != 0) {

              Swal.fire({
                icon: 'error',
                title: 'Alert',
                text: resdata['error_msg']
              })
              Swal.fire({
                icon: 'error',
                title: "Alert Message",
                text: resdata['error_msg'],
                type: "success"
              }).then(function() {

                $('#otp_modal').modal('show');

              });




            }

          }

        });

      }

      e.preventDefault();

    });
  </script>
</body>

</html>